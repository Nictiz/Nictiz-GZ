<?xml version="1.0" encoding="UTF-8"?>
<?xml-model href="../../sch/distribute-data.sch" type="application/xml" schematypens="http://purl.oclc.org/dsdl/schematron"?>
<distributions xmlns="https://nictiz.nl/ns/YATC-internal" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="https://nictiz.nl/ns/YATC-internal ../../xsd/distribute-data.xsd">
    <!-- ======================================================================= -->
    <!-- 
        The distributions for VZVZ
    -->
    <!-- ======================================================================= -->
    <!--
        Copyright Â© Nictiz
        
        This program is free software; you can redistribute it and/or modify it under the terms of the
        GNU Lesser General Public License as published by the Free Software Foundation; either version
        2.1 of the License, or (at your option) any later version.
        
        This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
        without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
        See the GNU Lesser General Public License for more details.
        
        The full text of the license is available at http://www.gnu.org/copyleft/lesser.html
    -->
    <!-- ======================================================================= -->

    <distribution name="MP9-Medicatieproces-9.3.0" description="MP9.3.0 distribution" target-directory="MP9/Medicatieproces-9.3.0-$DISTRIBUTIONVERSION" href-zip="../$DISTRIBUTIONNAME-$DISTRIBUTIONVERSION-$DATECOMPACT-$TIMECOMPACT.zip" base-dir-in-zip="false" allow-overwrite="false" source-directory="{$HL7-mappingsDirectory}" distribution-version-required="true" keep-files="true">

        <!-- This distribution specifically follows the original directory structure.
             Some master documents were specified twice, these are mentioned but are commented out.  
        -->

        <message>=============================== Medicatie Overdracht distribution for VZVZ</message>

        <flatten-stylesheets href-include="common/includes" add-addional-info="distribution-comment provenance-comment">
            
            <macros>
                <macro name="MPVERSION" value="9.3.0"/>
            </macros>

            <master-document-directory source-directory="hl7_2_ada/mp/$MPVERSION" target-directory="$SOURCE" recurse="true">
                <include glob="*.xsl"/>
            </master-document-directory>

            <master-document-directory source-directory="fhir_2_ada-r4/mp/$MPVERSION" target-directory="$SOURCE" recurse="true">
                <include glob="*.xsl"/>
            </master-document-directory>
            
            <master-document-directory source-directory="fhir_2_ada-r4/mp-lab" target-directory="$SOURCE" recurse="true">
                <include glob="*.xsl"/>
            </master-document-directory>

            <master-document-directory source-directory="ada_2_fhir-r4/mp/$MPVERSION" target-directory="$SOURCE" recurse="true">
                <include glob="*.xsl"/>
                <!-- REMARK: We're excluding the following stylesheet. This stylesheet is invalid (it imports a non-existent other stylesheet).
                     Since nobody ever noticed the error, the assumption is that it is not used. -->
                <exclude glob="beschikbaarstellen_medicatieoverzicht_2_fhir_resources.xsl"/>
            </master-document-directory>
            
            <!-- We also need the stylesheets from ada_2_hl7/mp/$MPVERSION. This was already moved to YATC-internal: -->
            <master-document-directory source-directory="{$yatcInternalDirectory}/ada-2-hl7/env/mp/$MPVERSION" target-directory="ada_2_hl7/mp/$MPVERSION" recurse="true">
                <include glob="*.xsl"/>
            </master-document-directory>
            
            <master-document-directory source-directory="{$yatcInternalDirectory}/ada-2-hl7/env/mp-lab" target-directory="ada_2_hl7/mp-lab" recurse="true">
                <include glob="*.xsl"/>
            </master-document-directory>

        </flatten-stylesheets>

        <!--Add the necessary data XML documents to the include directory: -->
        <directory source-directory="util" target-directory="common/includes" clear-target="false">
            <include glob="*.xml"/>
        </directory>
        <!-- We have to add the QualificationTokens.xml twice, because it is referenced with different paths from different stylesheets :( -->
        <directory source-directory="ada_2_fhir/fhir" target-directory="common/fhir">
            <include glob="QualificationTokens.xml"/>
        </directory>
        <directory source-directory="ada_2_fhir/fhir" target-directory="ada_2_fhir/fhir">
            <include glob="QualificationTokens.xml"/>
        </directory>

        <!-- Add an XML and Markdown information document: -->
        <additional-xml-document href-target="distribution-info.xml">
            <distribution xmlns="" name="$DISTRIBUTIONNAME" timestamp="$DATETIMEISO" version="$DISTRIBUTIONVERSION"/>
        </additional-xml-document>
        <additional-text-document href-source="#text/README-master.md" href-target="README.md"/>

    </distribution>

    <!-- ======================================================================= -->

    <distribution name="MP9-Medicatieproces-9.0.7" description="MP9.0.7 distribution" target-directory="MP9/Medicatieproces-9.0.7-$DISTRIBUTIONVERSION" href-zip="../$DISTRIBUTIONNAME-$DISTRIBUTIONVERSION-$DATECOMPACT-$TIMECOMPACT.zip" base-dir-in-zip="false" allow-overwrite="false" source-directory="{$HL7-mappingsDirectory}" distribution-version-required="true" keep-files="true">

        <!-- This distribution specifically follows the original directory structure.
             Some master documents were specified twice, these are mentioned but are commented out.  
        -->

        <message>=============================== Medicatie 907 distributie ===============================</message>

        <flatten-stylesheets href-include="common/includes" add-addional-info="distribution-comment provenance-comment">
            
            <macros>
                <macro name="MPVERSION" value="9.0.7"/>
            </macros>

            <master-document-directory source-directory="hl7_2_ada/mp/$MPVERSION" target-directory="$SOURCE" recurse="true">
                <include glob="*.xsl"/>
            </master-document-directory>

            <master-document-directory source-directory="{$yatcInternalDirectory}/fhir-2-ada/env/mp/$MPVERSION" target-directory="fhir_2_ada/mp/$MPVERSION" recurse="true">
                <include glob="*.xsl"/>
            </master-document-directory>
            

            <master-document-directory source-directory="{$yatcInternalDirectory}/ada-2-fhir/env/mp/$MPVERSION" target-directory="ada_2_fhir/mp/$MPVERSION" recurse="true">
                <include glob="*.xsl"/>
                <!-- REMARK: We're excluding the following stylesheet. This stylesheet is invalid (it imports a non-existent other stylesheet).
                     Since nobody ever noticed the error, the assumption is that it is not used. -->
                <exclude glob="beschikbaarstellen_medicatieoverzicht_2_fhir_resources.xsl"/>
            </master-document-directory>
            
            <!-- We also need the stylesheets from ada_2_hl7/mp/$MPVERSION. This was already moved to YATC-internal: -->
            <master-document-directory source-directory="{$yatcInternalDirectory}/ada-2-hl7/env/mp/$MPVERSION" target-directory="ada_2_hl7/mp/$MPVERSION" recurse="true">
                <include glob="*.xsl"/>
            </master-document-directory>
            
            <master-document-directory source-directory="{$yatcInternalDirectory}/ada-2-hl7/env/mp-lab" target-directory="ada_2_hl7/mp-lab" recurse="true">
                <include glob="*.xsl"/>
            </master-document-directory>

        </flatten-stylesheets>

        <!--Add the necessary data XML documents to the include directory: -->
        <directory source-directory="util" target-directory="common/includes" clear-target="false">
            <include glob="*.xml"/>
        </directory>
        <!-- We have to add the QualificationTokens.xml twice, because it is referenced with different paths from different stylesheets :( -->
        <directory source-directory="ada_2_fhir/fhir" target-directory="common/fhir">
            <include glob="QualificationTokens.xml"/>
        </directory>
        <directory source-directory="ada_2_fhir/fhir" target-directory="ada_2_fhir/fhir">
            <include glob="QualificationTokens.xml"/>
        </directory>

        <!-- Add an XML and Markdown information document: -->
        <additional-xml-document href-target="distribution-info.xml">
            <distribution xmlns="" name="$DISTRIBUTIONNAME" timestamp="$DATETIMEISO" version="$DISTRIBUTIONVERSION"/>
        </additional-xml-document>
        <additional-text-document href-source="#text/README-master.md" href-target="README.md"/>

    </distribution>

    <!-- ======================================================================= -->

    <distribution name="MP9-test-distribution" description="Test distribution for MP9 202311" target-directory="MP9/test-distribution" href-zip="../$DISTRIBUTIONNAME-$DATECOMPACT-$TIMECOMPACT.zip" base-dir-in-zip="false" allow-overwrite="true" source-directory="{$HL7-mappingsDirectory}">

        <!-- This was a very first attempt to create a distribution for VZVZ (contact: Helma van der Linden). It turned out that it was better to 
             make something that resembled the original directory structure, a so-called "drop-in" distribution. 
             Therefore, this distribution was reworked into the distribution named VZVZ-test-distribution-drop-in.
        -->

        <!-- The specification from VZVZ (Helma van der Linden) 20231116: 
        
            # HL7-mappings XSLTs

            # Ik gebruik telkens setjes toAda + fromAda.
            # $HL7Mappings verwijst naar de lokatie van de HL7 Mappings repository op mijn schijf
            
            toAda="$HL7Mappings"'/fhir_2_ada-r4/mp/9.3.0/beschikbaarstellen_medicatiegegevens/payload/beschikbaarstellen_medicatiegegevens_2_ada.xsl'
            fromAda="$HL7Mappings"'/ada_2_hl7/mp/9.3.0/beschikbaarstellen_medicatiegegevens/payload/beschikbaarstellen_medicatiegegevens_org.xsl'
            
            toAda="$HL7Mappings"'/hl7_2_ada/mp/9.3.0/beschikbaarstellen_medicatiegegevens/payload/beschikbaarstellen_medicatiegegevens_hl7_2_ada.xsl'
            fromAda="$HL7Mappings"'/ada_2_fhir-r4/mp/9.3.0/beschikbaarstellen_medicatiegegevens/payload/beschikbaarstellen_medicatiegegevens_2_fhir.xsl'
            
            # ik realiseer me nu dat hiervan nog geen mp-lab versie bestaat.
            toAda="$HL7Mappings"'/hl7_2_ada/mp/9.3.0/sturen_medicatievoorschrift/payload/sturen_medicatievoorschrift_hl7_2_ada.xsl'
            fromAda="$HL7Mappings"'/ada_2_fhir-r4/mp/9.3.0/sturen_medicatievoorschrift/payload/sturen_medicatievoorschrift_2_fhir.xsl'
            
            toAda="$HL7Mappings"'/fhir_2_ada-r4/mp-lab/payload/sturen_medicatievoorschrift-en-lab.xsl'
            fromAda="$HL7Mappings"'/ada_2_hl7/mp-lab/payload/sturen_medicatievoorschrift-en-lab.xsl'
            
            toAda="$HL7Mappings"'/hl7_2_ada/mp/9.3.0/6.12_2_beschikbaarstellen_medicatiegegevens/payload/6.12_2_beschikbaarstellen_medicatiegegevens_hl7_2_ada.xsl'
            fromAda="$HL7Mappings"'/ada_2_fhir-r4/mp/9.3.0/beschikbaarstellen_medicatiegegevens/payload/beschikbaarstellen_medicatiegegevens_2_fhir.xsl'
            
            toAda="$HL7Mappings"'/hl7_2_ada/mp/9.3.0/6.12_2_beschikbaarstellen_medicatiegegevens/payload/6.12_2_beschikbaarstellen_medicatiegegevens_hl7_2_ada.xsl'
            fromAda="$HL7Mappings"'/ada_2_hl7/mp/9.3.0/beschikbaarstellen_medicatiegegevens/payload/beschikbaarstellen_medicatiegegevens_org.xsl'
        -->

        <message>=============================== Test distribution for MP9</message>

        <flatten-stylesheets href-include="common/includes">

            <group target-directory="pair-1">
                <group target-directory="toAda">
                    <master-document href-source="fhir_2_ada-r4/mp/9.3.0/beschikbaarstellen_medicatiegegevens/payload/beschikbaarstellen_medicatiegegevens_2_ada.xsl"/>
                </group>
                <group target-directory="fromAda">
                    <master-document href-source="ada_2_hl7/mp/9.3.0/beschikbaarstellen_medicatiegegevens/payload/beschikbaarstellen_medicatiegegevens_org.xsl"/>
                </group>
            </group>

            <group target-directory="pair-2">
                <group target-directory="toAda">
                    <master-document href-source="hl7_2_ada/mp/9.3.0/beschikbaarstellen_medicatiegegevens/payload/beschikbaarstellen_medicatiegegevens_hl7_2_ada.xsl"/>
                </group>
                <group target-directory="fromAda">
                    <master-document href-source="ada_2_fhir-r4/mp/9.3.0/beschikbaarstellen_medicatiegegevens/payload/beschikbaarstellen_medicatiegegevens_2_fhir.xsl"/>
                </group>
            </group>

            <group target-directory="pair-3">
                <group target-directory="toAda">
                    <master-document href-source="hl7_2_ada/mp/9.3.0/sturen_medicatievoorschrift/payload/sturen_medicatievoorschrift_hl7_2_ada.xsl"/>
                </group>
                <group target-directory="fromAda">
                    <master-document href-source="ada_2_fhir-r4/mp/9.3.0/sturen_medicatievoorschrift/payload/sturen_medicatievoorschrift_2_fhir.xsl"/>
                </group>
            </group>

            <group target-directory="pair-4">
                <group target-directory="toAda">
                    <master-document href-source="fhir_2_ada-r4/mp-lab/payload/sturen_medicatievoorschrift-en-lab.xsl"/>
                </group>
                <group target-directory="fromAda">
                    <master-document href-source="ada_2_hl7/mp-lab/payload/sturen_medicatievoorschrift-en-lab.xsl"/>
                </group>
            </group>

            <group target-directory="pair-5">
                <group target-directory="toAda">
                    <master-document href-source="hl7_2_ada/mp/9.3.0/6.12_2_beschikbaarstellen_medicatiegegevens/payload/6.12_2_beschikbaarstellen_medicatiegegevens_hl7_2_ada.xsl"/>
                </group>
                <group target-directory="fromAda">
                    <master-document href-source="ada_2_fhir-r4/mp/9.3.0/beschikbaarstellen_medicatiegegevens/payload/beschikbaarstellen_medicatiegegevens_2_fhir.xsl"/>
                </group>
            </group>

            <group target-directory="pair-6">
                <group target-directory="toAda">
                    <master-document href-source="hl7_2_ada/mp/9.3.0/6.12_2_beschikbaarstellen_medicatiegegevens/payload/6.12_2_beschikbaarstellen_medicatiegegevens_hl7_2_ada.xsl"/>
                </group>
                <group target-directory="fromAda">
                    <master-document href-source="ada_2_hl7/mp/9.3.0/beschikbaarstellen_medicatiegegevens/payload/beschikbaarstellen_medicatiegegevens_org.xsl"/>
                </group>
            </group>

        </flatten-stylesheets>

        <!-- Finally, also add the necessary data XML documents to the include directory: -->
        <directory source-directory="util" target-directory="common/includes" clear-target="false">
            <include glob="*.xml"/>
        </directory>
        <!-- We have to add the QualificationTokens.xml twice, because it is referenced with different paths from different stylesheets :( -->
        <directory source-directory="ada_2_fhir/fhir" target-directory="common/fhir">
            <include glob="QualificationTokens.xml"/>
        </directory>
        <directory source-directory="ada_2_fhir/fhir" target-directory="ada_2_fhir/fhir">
            <include glob="QualificationTokens.xml"/>
        </directory>

    </distribution>

</distributions>
