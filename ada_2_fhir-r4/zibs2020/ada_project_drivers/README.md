# Project drivers

Whereas the "payload" folder contains pure zib/nl-core mappings to be re-used across ada projects, this folder contains drivers to handle the output specifically from the [zib2020-nl project on ART-DECOR](https://decor.nictiz.nl/art-decor/decor-project--zib2020bbr-) which can be found in the "ada_instance" folder and feed it to these zib/nl-core mappings.

A utility stylseheet called `_driverInclude` is provided to facilitate the creation of drivers for this project. 

A set of 'eoi' (Example of Instance) examples can be generated by calling generateExamples.bat.

## Bundling things

Zib instances will ofen refer to each other, and sometimes multiple zibs will be transformed into a single FHIR instance. In these cases, a driver will need to take multiple ADA instances into account and feed them in the right way to the template. This project offers a generic way to bundle things by specifying an instance file like this:

```xml
<bundle>
  <source href="instance1.xml"/>
  <source href="instance2.xml"/>
</bundle>
```

The `_driverInclude` stylesheet will unpack this into a variable called `$bundle`, which can be used to format the parameters to the stylesheet that performs the actual transformation. 

### Patient references
Specifically for the patient reference, a field for the patient identifier is added to ADA in this project. Drivers can use the template `_resolveAdaPatient` to find the patient instance from the files in the ADA instance folder, _or_ from the bundle. So for simple zibs that just refer a patient, it is not needed to create a bundle file. 
